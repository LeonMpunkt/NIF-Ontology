/*
 * This program reads an excel document that contains 2 columns - first for the source
 * and the second for the target URIs. Finally, this program writes an OWL file with OWLEquivalent statements between the mapping classes. 
 * @Fahim Imam (January 14, 2013)
 */

import java.io.BufferedInputStream;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.Iterator;

import org.apache.poi.hssf.usermodel.HSSFCell;
import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.poifs.filesystem.POIFSFileSystem;


public class SetOWLEquivalence {
	static ArrayList<String> srcURI = new ArrayList<String>();
    static ArrayList<String> targetURI = new ArrayList<String>();
	
    public static void main (String[] args)
	{
	    String srcClassURI = "";    // If the mapping excel file only contains Class ID, 
	    String targetClassURI = ""; // please insert the URI portion of the Class ID here.
		
		String excelFileName = "NIFSTD-PRO-Mappings.xls";
		loadExcelDocument(srcClassURI, targetClassURI, excelFileName);
	}

public static void loadExcelDocument(String src, String target, String fileName)
{
	try 
    {
        InputStream input = new BufferedInputStream(
                    new FileInputStream(fileName)); //Note: Only works with xls file not xslx.
        POIFSFileSystem fs = new POIFSFileSystem( input );
        HSSFWorkbook wb = new HSSFWorkbook(fs);
        HSSFSheet sheet = wb.getSheetAt(0);
        
        Iterator rows = sheet.rowIterator();
        while( rows.hasNext() ) 
        {  
            HSSFRow row = (HSSFRow) rows.next();
            //System.out.println("\n");
            Iterator cells = row.cellIterator();
          
            while( cells.hasNext() ) 
            {
               HSSFCell cell = (HSSFCell) cells.next();
                if (cell.getColumnIndex() == 0)
            	  {
            	  	System.out.print("\n new row.\n");
            	    srcURI.add(cell.getStringCellValue());         	  	
            	  }
                else 
                	targetURI.add(cell.getStringCellValue());
                
             } //End of while block 2.
            
            
        } //End of while block 1.
        
     writeOWLEquivFile(); 
    } // End of try block.
    
    catch ( IOException ex ) 
    {
        ex.printStackTrace();
    } // End of catch.
}

public static void writeOWLEquivFile()
	{
		String OWLStatement = "";
		Iterator <String>srcItr = srcURI.iterator();
		Iterator <String>targetItr = targetURI.iterator();
		
	     while(srcItr.hasNext()) // loop thro elements
	          {
	    	    //System.out.println(srcItr.next()); 
		
				OWLStatement = "\n<owl:Class rdf:about=\"" + srcItr.next() + "\"/>";
				OWLStatement += "\n<owl:equivalentClass rdf:resource=\"" + targetItr.next() + "\"/>";
				OWLStatement += "\n</owl:Class>";
	            
				System.out.println(OWLStatement);
	          }
		/*
		OWL Equivalent Statement format:
		<owl:Class rdf:about="http://purl.obolibrary.org/obo/ERO_0000019"/>	
		  <owl:equivalentClass rdf:resource="http://ontology.neuinfo.org/NIF/DigitalEntities/NIF-Investigation.owl#nlx_inv_20090407"/>
		</owl:Class> 
		*/	
	}

}
