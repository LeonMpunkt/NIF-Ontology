import java.io.BufferedInputStream;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.Iterator;

import org.apache.poi.hssf.usermodel.HSSFCell;
import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.poifs.filesystem.POIFSFileSystem;


public class SetOWLEquivalence {
	public static void main (String[] args)
	{
	    String srcClassURI = ""; // If the mapping excel file only contains Class ID, please insert the URI portion of the Class ID here
	    String targetClassURI = ""; 
		readExcel(srcClassURI, targetClassURI);
	}

public static void readExcel(String src, String target)
{
	try 
    {
        InputStream input = new BufferedInputStream(
                    new FileInputStream("NIFSTD-PRO-Mappings.xls")); //Note: Only works with xls file not xslx.
        POIFSFileSystem fs = new POIFSFileSystem( input );
        HSSFWorkbook wb = new HSSFWorkbook(fs);
        HSSFSheet sheet = wb.getSheetAt(0);
        
		
        
        String data; 
		data = "";
		int lastColIndex = 0;
		
		
		
        Iterator rows = sheet.rowIterator();
        while( rows.hasNext() ) 
        {  
            HSSFRow row = (HSSFRow) rows.next();
            //System.out.println("\n");
            Iterator cells = row.cellIterator();
            
            
            while( cells.hasNext() ) 
            {
                 
                HSSFCell cell = (HSSFCell) cells.next();
              /*  if(HSSFCell.CELL_TYPE_NUMERIC==cell.getCellType())
                System.out.print( cell.getNumericCellValue()+"     " );
                else */
              if (cell.getColumnIndex() == 0)
            	  {
            	  	System.out.print("\n new row.\n");
            	  	data += "\n<owl:Class rdf:about=";
            	  	lastColIndex = 0;
            	  	System.out.print (lastColIndex);
            	  }
                
              if(HSSFCell.CELL_TYPE_STRING==cell.getCellType())
                    {
            	  			 
            	  	System.out.print( " COL["+ cell.getColumnIndex() + "]" );
            	  	data += "\""+cell.getStringCellValue(); // concatenate the Src URI.
            	  	data += "/\"><owl:equivalentClass rdf:resource=";			
            	  	 
                    }
                /*else
                    if(HSSFCell.CELL_TYPE_BOOLEAN==cell.getCellType())
                    System.out.print( cell.getBooleanCellValue()+"     " );
                    else*/
                else if(HSSFCell.CELL_TYPE_BLANK==cell.getCellType())
                    System.out.print( "BLANK" );
                    else
                    	System.out.print("Unknown cell type");
              
             System.out.print("(LAST COL:" +lastColIndex + ")");
              lastColIndex +=1;
            } //End of while block 2.
            
            
        } //End of while block 1.
        
   System.out.print(data);     
    } // End of try block.
    
    catch ( IOException ex ) 
    {
        ex.printStackTrace();
    } // End of catch.
}

}
